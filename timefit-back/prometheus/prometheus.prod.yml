# ============================================================
# prod 환경용 Prometheus 설정
# 
# 용도: Docker 네트워크 내(timefit-backend:8080)에서 실행 중인
#       Spring Boot의 메트릭을 수집
# ============================================================

global:
  scrape_interval: 15s      # 15초마다 메트릭 수집
  evaluation_interval: 15s  # 15초마다 규칙 평가
  external_labels:
    monitor: 'timefit-monitor'

# Alertmanager 설정 (나중에 추가 가능)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets: ['alertmanager:9093']

scrape_configs:
  # ────────────────────────────────────────────────────────────
  # Prometheus 자체 모니터링
  # ────────────────────────────────────────────────────────────
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # ────────────────────────────────────────────────────────────
  # Spring Boot Actuator (Docker 네트워크 내)
  # ────────────────────────────────────────────────────────────
  - job_name: 'timefit-backend'
    metrics_path: '/actuator/prometheus'
    scrape_interval: 5s  # 성능 테스트 시 더 짧은 간격
    static_configs:
      - targets: ['timefit-backend:8080']  # ← Docker 서비스 이름
        labels:
          application: 'timefit'
          environment: 'prod'

  # ────────────────────────────────────────────────────────────
  # Nginx Exporter
  # ────────────────────────────────────────────────────────────
  - job_name: 'nginx'
    scrape_interval: 5s
    static_configs:
      - targets: ['nginx-exporter:9113']
        labels:
          application: 'timefit'
          component: 'nginx'
